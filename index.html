
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registro de Donaciones PCZ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      margin: 0;
      padding: 2rem;
      text-align: center;
    }
    form {
      background: white;
      padding: 1.5rem;
      border-radius: 10px;
      max-width: 500px;
      margin: auto;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    input {
      width: 100%;
      padding: 0.6rem;
      margin-top: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    button {
      margin-top: 1.5rem;
      padding: 0.75rem 1.5rem;
      background-color: #1976d2;
      color: white;
      border: none;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
    }
    canvas {
      margin-top: 2rem;
      border: 2px solid #1976d2;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    #whatsapp {
      margin-top: 1rem;
      display: none;
      font-size: 1.1rem;
    }
  </style>
</head>
<body>
  <h1>Registro de Donaciones</h1>
  <form id="donacionForm">
    <input type="text" id="nombre" placeholder="Nombre completo" required />
    <input type="tel" id="telefono" placeholder="Número de teléfono" required />
    <input type="text" id="poblacion" placeholder="Población" required />
    <input type="number" id="cantidad" placeholder="Cantidad entregada ($)" required />
    <button type="submit">Enviar donación</button>
  </form>

  <canvas id="reciboCanvas" width="540" height="720"></canvas>
  <a id="whatsapp" target="_blank">📲 Enviar por WhatsApp</a>

  <script>
    const frases = [
      "Gracias por tu generoso apoyo. Cada peso salva vidas.",
      "Tu ayuda fortalece a nuestros héroes voluntarios.",
      "Zacualpan te agradece tu solidaridad.",
      "Cada peso es un paso hacia la esperanza.",
      "Con tu donación, salvas vidas.",
      "El valor de un pueblo está en su gente.",
      "Tu apoyo es más que un gesto: es una causa noble.",
      "Hoy diste un paso por todos nosotros.",
      "Un peso con amor vale más que mil indiferentes.",
      "¡Gracias por ser parte de esta misión de vida!"
    ];

    document.getElementById("donacionForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const nombre = document.getElementById("nombre").value;
      const telefono = document.getElementById("telefono").value;
      const poblacion = document.getElementById("poblacion").value;
      const cantidad = document.getElementById("cantidad").value;
      const frase = frases[Math.floor(Math.random() * frases.length)];

      let folio = localStorage.getItem("folioPCZ") || 1;
      const canvas = document.getElementById("reciboCanvas");
      const ctx = canvas.getContext("2d");

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "#fff";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Marcos
      ctx.strokeStyle = "#003399";
      ctx.lineWidth = 8;
      ctx.strokeRect(10, 10, canvas.width - 20, canvas.height - 20);
      ctx.strokeStyle = "#FFCC00";
      ctx.lineWidth = 6;
      ctx.strokeRect(20, 20, canvas.width - 40, canvas.height - 40);

      ctx.fillStyle = "#000";
      ctx.font = "bold 34px Arial";
      ctx.fillText("RECIBO DE DONACIÓN", 70, 60);

      ctx.font = "26px Arial";
      let y = 120;
      ctx.fillText("Folio: PCZ-" + String(folio).padStart(4, "0"), 30, y); y += 40;
      ctx.fillText("Nombre del donador: " + nombre, 30, y); y += 40;
      ctx.fillText("Población: " + poblacion, 30, y); y += 40;
      ctx.fillText("Cantidad entregada: $" + cantidad + " MXN", 30, y); y += 40;

      const fecha = new Date().toLocaleString("es-MX");
      ctx.fillText("Fecha: " + fecha, 30, y); y += 60;

      const logo = new Image();
      logo.onload = function () {
        ctx.drawImage(logo, 200, y, 120, 120);

        ctx.font = "24px Arial";
        const lines = frase.match(/.{1,38}(\s|$)/g);
        let fy = canvas.height - 60;
        lines.forEach((line, i) => {
          ctx.fillText(line.trim(), 30, fy + i * 26);
        });

        const link = document.getElementById("whatsapp");
        link.href = `https://wa.me/?text=Hola!%20Acabo%20de%20realizar%20una%20donación%20a%20Protección%20Civil%20Zacualpan.%20Folio%3A%20PCZ-${String(folio).padStart(4, "0")}`;
        link.style.display = "block";

        localStorage.setItem("folioPCZ", parseInt(folio) + 1);
      };
      logo.src = "https://github.com/manuelstaz/proteccion-civil-zacualpan/blob/main/patronato%20logo.JPG?raw=true";
    });
  </script>
</body>
</html>
